
module may.transform.test.test_fft;

{ realForward, realForwardMagnitude, realInverse } = load may.transform.fft;
{ list, fromList } = load may.vector;
{ complex, magnitude } = load may.complex;

{ compare } = load may.test.test;

testFFT orig reals imags =
   (out = realForward (length orig) (fromList orig);
    outmag = realForwardMagnitude (length orig) (fromList orig);
    back = realInverse (length orig) out;
    compare out (array (map2 complex reals imags)) and
        compare (list back) orig and
        compare (list outmag) (map2 do r i: magnitude (complex r i) done
                               reals imags)
    );

[

"dc": \(
    testFFT [1,1,1,1] [4,0,0] [0,0,0];
),

"sine": \(
    testFFT [0,1,0,-1] [0,0,0] [0,-2,0];
),

"cosine": \(
    testFFT [1,0,-1,0] [0,2,0] [0,0,0];
),

"sineCosine": \(
    testFFT [0.5,1,-0.5,-1] [0,1,0] [0,-2,0];
),

"nyquist": \(
    testFFT [1,-1,1,-1] [0,0,4] [0,0,0];
),

"dirac": \(
    testFFT [1,0,0,0] [1,1,1] [0,0,0] and
        testFFT [0,1,0,0] [1,0,-1] [0,-1,0] and
        testFFT [0,0,1,0] [1,-1,1] [0,0,0] and
        testFFT [0,0,0,1] [1,0,-1] [0,1,0];
),

] is hash<string, () -> boolean>;


